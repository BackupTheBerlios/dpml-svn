<?xml version="1.0" encoding="UTF-8" ?>

<project name="dpml-test-plus-unit" default="install" basedir="."
    xmlns:transit="antlib:net.dpml.transit" 
    xmlns:x="plugin:dpml/magic/dpml-magic-core"
    xmlns:c="plugin:dpml/composition/dpml-composition-builder">

  <transit:import uri="local:template:magic/standard"/>

  <target name="init" depends="standard.init">
    <x:property key="dpml-part-api" feature="uri" type="plugin" name="part.plugin"/>
    <filter token="PART-MANAGER-PLUGIN" value="${part.plugin}"/>
    <x:property key="dpml-test-simple" feature="uri" type="part" name="simple.part"/>
    <filter token="SIMPLE-TEST-PART" value="${simple.part}"/>
    <x:property key="dpml-test-plus" feature="uri" type="part" name="plus.part"/>
    <filter token="PLUS-TEST-PART" value="${plus.part}"/>
  </target>

  <target name="build" depends="standard.build">

    <!--
    Configuration examples.
    -->
    <c:component dest="target/test/configurable-container.part"
        type="net.dpml.test.acme.plus.ConfigurableContainer"
        name="container">
      <configuration>
        <test>
          <color>red</color>
        </test>
      </configuration>
      <parts>
        <component name="test" type="net.dpml.test.acme.plus.ConfigurableComponent">
          <configuration>
            <color>blue</color>
          </configuration>
        </component>
      </parts>
    </c:component>

    <!-- 
    State management examples.
    -->
    <c:component dest="target/test/managed-component.part" 
        type="net.dpml.test.acme.plus.ManagedComponent"
        name="component"/>
    <c:component dest="target/test/managing-container.part" 
        xmlns="plugin:dpml/composition/dpml-composition-builder" 
        type="net.dpml.test.acme.plus.ManagingContainer"
        name="container">
      <parts>
        <component key="test" type="net.dpml.test.acme.plus.ManagedComponent"/>
      </parts>
    </c:component>

  </target>

  <target name="package" depends="build"/>
  <target name="install" depends="test"/>

</project>
